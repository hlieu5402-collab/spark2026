# CEP-0001: 公共 API 稳定性等级示例

- 作者：@spark-rs/arch-board
- 审批人：@spark-rs/core-maintainers，@spark-rs/release-engineering
- 创建日期：2024-03-15
- 状态：已定稿
- 版本：v1.0

## 摘要
- 定义 Spark 公共 API 的稳定性等级与演进策略，为后续公共 API 调整提供标准流程。

## 背景与动机
- 项目正逐步开放稳定 API，但缺少统一的兼容性承诺与废弃策略；
- 不同模块的发布节奏不一致，难以保证外部集成方的升级体验。

## 目标与非目标
- 目标：给出 API 稳定性等级、废弃最短通知期以及必要的迁移保障；
- 非目标：不覆盖内部实验性接口，也不讨论具体模块的实现细节。

## 方案概述
- 将 API 分为 `experimental`、`beta`、`stable` 三个等级，对应不同的发布节奏与支持承诺；
- 废弃流程要求在 `stable` 等级下至少提供两个小版本的并行支持，并发布迁移指南；
- 为 `beta` 与 `stable` API 的重大变更引入强制 CEP 流程，并要求代码仓库中的实现 PR 引用编号。

## 兼容性与迁移
- 对现有 `stable` API 的破坏性调整需提供兼容层或升级工具；
- 若无法提供兼容层，必须在 CEP 中给出明确的回滚方案与降级路径。

## 影响分析
- 性能：对运行时无直接影响；
- 稳定性：通过统一流程降低破坏性变更的风险；
- 安全性：无直接影响。

## 替代方案
- 方案 A：保持现状，由各模块自行决定 API 政策；
  - 放弃原因：缺乏统一标准，导致外部生态体验不佳。
- 方案 B：仅针对 `stable` API 要求 CEP；
  - 放弃原因：`beta` API 也已被部分用户依赖，需要纳入治理范围。

## 开放问题
- 是否需要将 `experimental` API 纳入版本化发布：暂缓，待更多反馈。

## 实施计划
1. 公布稳定性等级定义，并同步至文档站点；
2. 更新 PR 模板和 CODEOWNERS，确保公共 API 目录需要相应审批；
3. 在后续公共 API 调整中试运行流程，并收集改进建议。

## 变更记录
- 2024-03-15：初版定稿，发布稳定性等级定义与治理要求。
